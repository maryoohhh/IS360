---------------------------------------------------------------------
-- LAB GROUP BY
--
-- Exercise 1
---------------------------------------------------------------------

USE TSQL2018;
GO

---------------------------------------------------------------------
-- Task 1
-- Query the Sales.Orders table to return all orders grouped by employee
-- Use COUNT() to calculate the number of orders for each employee and give the column a name



-- Query the Sales.Orders table to return all orders grouped by customer
-- Use COUNT() to calculate the number of orders for each customer and give the column a name




---------------------------------------------------------------------
--
-- Task 2
-- 
-- Query the Sales.Customers table to return all customers grouped by country
-- Use COUNT() to calculate the number of customers in each country and give the column a name
--
-- Execute the written statement.

-- Modify the query to sort the results by the city column.
-- Execute the written statement.
-- What error do you get?
-- How can you fix it?
-- if you add 'city' to the GROUP BY list, how does this affect the number of groups?

---------------------------------------------------------------------





---------------------------------------------------------------------
-- Task 3
-- 
-- Write a SELECT statement that will return groups of rows from the Sales.Orders table based on the custid column
-- and a calculated column orderyear representing the order year based on the orderdate column. 
-- Filter the results to include only the orders from the sales employee whose empid equal five.
-- Sort the groups based on the empid and year value.

-- Execute the written statement.

---------------------------------------------------------------------





---------------------------------------------------------------------

